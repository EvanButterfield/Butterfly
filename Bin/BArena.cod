; Listing generated by Microsoft (R) Optimizing Compiler Version 19.34.31935.0 

include listing.inc

INCLUDELIB LIBCMTD
INCLUDELIB OLDNAMES

PUBLIC	BInitializeArena
PUBLIC	BArenaAlloc
EXTRN	BAlloc:PROC
pdata	SEGMENT
$pdata$BInitializeArena DD imagerel $LN3
	DD	imagerel $LN3+87
	DD	imagerel $unwind$BInitializeArena
$pdata$BArenaAlloc DD imagerel $LN4
	DD	imagerel $LN4+96
	DD	imagerel $unwind$BArenaAlloc
pdata	ENDS
xdata	SEGMENT
$unwind$BInitializeArena DD 031001H
	DD	0700c8210H
	DD	0600bH
$unwind$BArenaAlloc DD 010e01H
	DD	0220eH
xdata	ENDS
; Function compile flags: /Odtp
; File W:\Butterfly\Butterfly\src\Allocators\BArena.c
_TEXT	SEGMENT
Memory$1 = 0
Arena$ = 32
Size$ = 40
BArenaAlloc PROC

; 14   : {

$LN4:
  00000	48 89 54 24 10	 mov	 QWORD PTR [rsp+16], rdx
  00005	48 89 4c 24 08	 mov	 QWORD PTR [rsp+8], rcx
  0000a	48 83 ec 18	 sub	 rsp, 24

; 15   :     if(Arena->Used + Size <= Arena->Size)

  0000e	48 8b 44 24 20	 mov	 rax, QWORD PTR Arena$[rsp]
  00013	48 8b 40 08	 mov	 rax, QWORD PTR [rax+8]
  00017	48 03 44 24 28	 add	 rax, QWORD PTR Size$[rsp]
  0001c	48 8b 4c 24 20	 mov	 rcx, QWORD PTR Arena$[rsp]
  00021	48 3b 41 10	 cmp	 rax, QWORD PTR [rcx+16]
  00025	77 32		 ja	 SHORT $LN2@BArenaAllo

; 16   :     {
; 17   :         u8 *Memory = Arena->Memory + Arena->Used;

  00027	48 8b 44 24 20	 mov	 rax, QWORD PTR Arena$[rsp]
  0002c	48 8b 00	 mov	 rax, QWORD PTR [rax]
  0002f	48 8b 4c 24 20	 mov	 rcx, QWORD PTR Arena$[rsp]
  00034	48 03 41 08	 add	 rax, QWORD PTR [rcx+8]
  00038	48 89 04 24	 mov	 QWORD PTR Memory$1[rsp], rax

; 18   :         Arena->Used += Size;

  0003c	48 8b 44 24 20	 mov	 rax, QWORD PTR Arena$[rsp]
  00041	48 8b 40 08	 mov	 rax, QWORD PTR [rax+8]
  00045	48 03 44 24 28	 add	 rax, QWORD PTR Size$[rsp]
  0004a	48 8b 4c 24 20	 mov	 rcx, QWORD PTR Arena$[rsp]
  0004f	48 89 41 08	 mov	 QWORD PTR [rcx+8], rax

; 19   :         return Memory;

  00053	48 8b 04 24	 mov	 rax, QWORD PTR Memory$1[rsp]
  00057	eb 02		 jmp	 SHORT $LN1@BArenaAllo
$LN2@BArenaAllo:

; 20   :     }
; 21   :     
; 22   :     return 0;

  00059	33 c0		 xor	 eax, eax
$LN1@BArenaAllo:

; 23   : }

  0005b	48 83 c4 18	 add	 rsp, 24
  0005f	c3		 ret	 0
BArenaAlloc ENDP
_TEXT	ENDS
; Function compile flags: /Odtp
; File W:\Butterfly\Butterfly\src\Allocators\BArena.c
_TEXT	SEGMENT
Arena$ = 32
__$ReturnAddress$ = 96
Size$ = 104
BInitializeArena PROC

; 5    : {

$LN3:
  00000	48 89 54 24 10	 mov	 QWORD PTR [rsp+16], rdx
  00005	48 89 4c 24 08	 mov	 QWORD PTR [rsp+8], rcx
  0000a	56		 push	 rsi
  0000b	57		 push	 rdi
  0000c	48 83 ec 48	 sub	 rsp, 72			; 00000048H

; 6    :     btf_arena Arena;
; 7    :     Arena.Memory = BAlloc(MEM_TYPE_ARENA, Size);

  00010	48 8b 54 24 68	 mov	 rdx, QWORD PTR Size$[rsp]
  00015	b9 02 00 00 00	 mov	 ecx, 2
  0001a	e8 00 00 00 00	 call	 BAlloc
  0001f	48 89 44 24 20	 mov	 QWORD PTR Arena$[rsp], rax

; 8    :     Arena.Used = 0;

  00024	48 c7 44 24 28
	00 00 00 00	 mov	 QWORD PTR Arena$[rsp+8], 0

; 9    :     Arena.Size = Size;

  0002d	48 8b 44 24 68	 mov	 rax, QWORD PTR Size$[rsp]
  00032	48 89 44 24 30	 mov	 QWORD PTR Arena$[rsp+16], rax

; 10   :     return Arena;

  00037	48 8d 44 24 20	 lea	 rax, QWORD PTR Arena$[rsp]
  0003c	48 8b 7c 24 60	 mov	 rdi, QWORD PTR __$ReturnAddress$[rsp]
  00041	48 8b f0	 mov	 rsi, rax
  00044	b9 18 00 00 00	 mov	 ecx, 24
  00049	f3 a4		 rep movsb
  0004b	48 8b 44 24 60	 mov	 rax, QWORD PTR __$ReturnAddress$[rsp]

; 11   : }

  00050	48 83 c4 48	 add	 rsp, 72			; 00000048H
  00054	5f		 pop	 rdi
  00055	5e		 pop	 rsi
  00056	c3		 ret	 0
BInitializeArena ENDP
_TEXT	ENDS
END
